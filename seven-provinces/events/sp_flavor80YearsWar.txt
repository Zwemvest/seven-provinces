########################################
# Events for the 80 Years War and the Dutch independance
#
# written by Rik Oostveen
########################################


namespace = sp_flavor_80yw
normal_or_historical_nations = yes

#Dutch Agitation
country_event = {
    id = sp_flavor_80yw.1
    title = "sp_flavor_80yw.1.t"
	desc = {
		trigger = { 
			OR = { 
				tag = CAS 
				tag = SPA
			} 
			religion = catholic
			any_owned_province = {		
				region = low_countries_region
				OR = {
					culture = dutch
					culture = frisian
					culture = flemish
				}
				NOT = { religion = catholic }
			}
		}
		desc = "sp_flavor_80yw.1.d1"
	}
	desc = {
		trigger = { 
			OR = { 
				tag = CAS 
				tag = SPA
			} 
			religion = catholic
			NOT = {
				any_owned_province = {		
					region = low_countries_region
					OR = {
						culture = dutch
						culture = frisian
						culture = flemish
					}
					NOT = { religion = catholic }
				}
			}
		}
		desc = "sp_flavor_80yw.1.d2"
	}
	desc = {
		trigger = { 
			OR = { 
				tag = CAS 
				tag = SPA
			}
			NOT = { religion = catholic } 
		}
		desc = "sp_flavor_80yw.1.d3"
	}
	desc = {
		trigger = { 
			NOT = {
				OR = { 
					tag = CAS 
					tag = SPA
				} 
			}
			religion = catholic
			any_owned_province = {		
				region = low_countries_region
				OR = {
					culture = dutch
					culture = frisian
					culture = flemish
				}
				NOT = { religion = catholic }
			}
		}
		desc = "sp_flavor_80yw.1.d4"
	}
	desc = {
		trigger = { 
			NOT = {
				OR = { 
					tag = CAS 
					tag = SPA
				} 
			}
			religion = catholic
			NOT = {
				any_owned_province = {		
					region = low_countries_region
					OR = {
						culture = dutch
						culture = frisian
						culture = flemish
					}
					NOT = { religion = catholic }
				}
			}
		}
		desc = "sp_flavor_80yw.1.d5"
	}
	desc = {
		trigger = { 
			NOT = {
				OR = { 
					tag = CAS 
					tag = SPA
				} 
			}
			NOT = { religion = catholic } 
		}
		desc = "sp_flavor_80yw.1.d6"
	}
    picture = CIVIL_WAR_eventPicture

    trigger = {
        current_age = age_of_reformation
		is_year = 1550
		NOT = { has_global_flag = sp_flavor_80yw_dutch_independence } 
		NOT = { exists = NED }
		is_free_or_tributary_trigger = yes
		num_of_cities = 6
		any_owned_province = {
			region = low_countries_region
		}
		NOT = { 
			OR = {
				primary_culture = dutch
				primary_culture = frisian
				primary_culture = flemish
			}
		}
		OR = {
			any_owned_province = {		
				region = low_countries_region
				OR = {
					culture = dutch
					culture = frisian
					culture = flemish
				}
				OR = {
					has_owner_accepted_culture = no
					NOT = { tolerance_to_this = 0 }
				}
			}
			has_country_flag = bur_successor
		}
    }

    mean_time_to_happen = {
        months = 2500
		# Less aggressive against players :) 
		modifier = {
			factor = 2
			was_player = yes
		}
		# Not protestant/reformed 
		# (Event can still trigger for protestant/reformed nations owning catholic provinces!)
		modifier = {
			factor = 0.5
			NOT = {
				OR = {
					religion = reformed
					religion = protestant
				}
			}
			any_owned_province = {
				region = low_countries_region
				OR = {
					culture = dutch
					culture = frisian
					culture = flemish
				}
				has_owner_religion = no
				OR = {
					religion = reformed
					religion = protestant
				}
			}
		}
		# Enclave
		modifier = {
			factor = 0.5
			any_owned_province = {
				region = low_countries_region
				OR = {
					culture = dutch
					culture = frisian
					culture = flemish
				}
				is_in_capital_area = no
			}
		}
		# Not accepted culture 1
		modifier = {
			factor = 0.75		
			num_of_owned_provinces_with = {			
				value = 2	
				region = low_countries_region
				OR = {
					culture = dutch
					culture = frisian
					culture = flemish
				}
				has_owner_accepted_culture = no
			}
		}
		# Not accepted culture 2
		modifier = {
			factor = 0.75		
			num_of_owned_provinces_with = {			
				value = 4	
				region = low_countries_region
				OR = {
					culture = dutch
					culture = frisian
					culture = flemish
				}
				has_owner_accepted_culture = no
			}
		}
		# Not accepted culture 3
		modifier = {
			factor = 0.75		
			num_of_owned_provinces_with = {			
				value = 6
				region = low_countries_region
				OR = {
					culture = dutch
					culture = frisian
					culture = flemish
				}
				has_owner_accepted_culture = no
			}
		}
		# Not accepted culture 4
		modifier = {
			factor = 0.75		
			num_of_owned_provinces_with = {			
				value = 8
				region = low_countries_region
				OR = {
					culture = dutch
					culture = frisian
					culture = flemish
				}
				has_owner_accepted_culture = no
			}
		}
		# Religious conflict 1
		modifier = {
			factor = 0.75		
			num_of_owned_provinces_with = {			
				value = 2		
				region = low_countries_region
				OR = {
					culture = dutch
					culture = frisian
					culture = flemish
				}
				NOT = { tolerance_to_this = 0 }
			}
		}
		# Religious conflict 2
		modifier = {
			factor = 0.75		
			num_of_owned_provinces_with = {			
				value = 4		
				region = low_countries_region
				OR = {
					culture = dutch
					culture = frisian
					culture = flemish
				}
				NOT = { tolerance_to_this = 0 }
			}
		}
		# Religious conflict 3
		modifier = {
			factor = 0.75		
			num_of_owned_provinces_with = {			
				value = 6		
				region = low_countries_region
				OR = {
					culture = dutch
					culture = frisian
					culture = flemish
				}
				NOT = { tolerance_to_this = 0 }
			}
		}
		# Religious conflict 4
		modifier = {
			factor = 0.75		
			num_of_owned_provinces_with = {			
				value = 8		
				region = low_countries_region
				OR = {
					culture = dutch
					culture = frisian
					culture = flemish
				}
				NOT = { tolerance_to_this = 0 }
			}
		}
		# Autonomy conflict 1
		modifier = {
			factor = 0.75		
			num_of_owned_provinces_with = {			
				value = 2		
				region = low_countries_region
				OR = {
					culture = dutch
					culture = frisian
					culture = flemish
				}
				unrest = 1
			}
		}
		# Autonomy conflict 2
		modifier = {
			factor = 0.75		
			num_of_owned_provinces_with = {			
				value = 4		
				region = low_countries_region
				OR = {
					culture = dutch
					culture = frisian
					culture = flemish
				}
				unrest = 1
			}
		}
		# Autonomy conflict 3
		modifier = {
			factor = 0.75		
			num_of_owned_provinces_with = {			
				value = 6		
				region = low_countries_region
				OR = {
					culture = dutch
					culture = frisian
					culture = flemish
				}
				unrest = 1
			}
		}
		# Autonomy conflict 4
		modifier = {
			factor = 0.75		
			num_of_owned_provinces_with = {			
				value = 8		
				region = low_countries_region
				OR = {
					culture = dutch
					culture = frisian
					culture = flemish
				}
				unrest = 1
			}
		}
    }
	
	immediate = {
		hidden_effect = {		
			set_country_flag = sp_flavor_80yw_begin
			set_global_flag = sp_flavor_80yw_dutch_independence
			every_country = {
				limit = {
					NOT = { has_country_flag = sp_flavor_80yw_begin }
					any_owned_province = {
						OR = {
							area = holland_area
							area = netherlands_area
							area = frisia_area
						}
					}
				}
				country_event = {
					id = sp_flavor_80yw.2
				}
			}
			country_event = {
				id = sp_flavor_80yw.50
				days = 365
			}
		}
	}

    # Harsh measures
    option = {
        name = "sp_flavor_80yw.1.a"
		
		low_countries_region = {
			add_province_modifier = { 
				name = sp_begin_harsh_province
				duration = 7300
			}
		}

		set_country_flag = sp_flavor_80yw_begin_harsh_flag
		custom_tooltip = sp_flavor_80yw_antagonize
    }
    # Promise concessions
    option = {
        name = "sp_flavor_80yw.1.b"
		
		low_countries_region = {
			add_province_modifier = { 
				name = sp_begin_concede_province
				duration = 7300
			}
		}

		set_country_flag = sp_flavor_80yw_begin_concede_flag
		custom_tooltip = sp_flavor_80yw_placate
    }
}

#Unrest in the Netherlands
country_event = {
	id = sp_flavor_80yw.2
    title = "sp_flavor_80yw.2.t"
    desc = "sp_flavor_80yw.2.d"
    picture = CIVIL_WAR_eventPicture
		
	is_triggered_only = yes
	
    # We shall watch these developments with great interest
    option = {
		trigger = {
			OR = {
				primary_culture = dutch
				primary_culture = frisian
				primary_culture = flemish
				primary_culture = wallonian
			}
		}
        name = "sp_flavor_80yw.2.a"
    }
    # Let's remain cautious
    option = {
		trigger = {
			NOT = {
				OR = {
					primary_culture = dutch
					primary_culture = frisian
					primary_culture = flemish
					primary_culture = wallonian
				}
			}
		}
        name = "sp_flavor_80yw.2.b"
    }
}

# Alva
country_event = {
	id = sp_flavor_80yw.50
    title = "sp_flavor_80yw.50.t"
	
	is_triggered_only = yes

	desc = {
		trigger = { 
			OR = { 
				tag = CAS 
				tag = SPA
			} 
		}
		desc = "sp_flavor_80yw.50.d1"
	}
	desc = {
		trigger = { 
			NOT = {
				OR = { 
					tag = CAS 
					tag = SPA
				} 
			}
		}
		desc = "sp_flavor_80yw.50.d2"
	}
    picture = CIVIL_WAR_eventPicture
	
	immediate = {
		hidden_effect = {
			set_country_flag = sp_flavor_80yw_alva
			country_event = {
				id = sp_flavor_80yw.51
				days = 365
			}
		}
	}

    # Send Alva to replace the governor and restore order
    option = {
		trigger = {
			OR = { 
				tag = CAS 
				tag = SPA
			} 
		}
        name = "sp_flavor_80yw.50.a"

		define_general =  {	
			name = "Fadrique √Ålv. de Toledo"
			fire = 3	
			shock = 5	
			manuever = 4	
			siege = 3
		}
		capital_scope = {
			infantry = ROOT
			infantry = ROOT
			infantry = ROOT
			infantry = ROOT
			infantry = ROOT
			infantry = ROOT
			cavalry = ROOT
			cavalry = ROOT
			cavalry = ROOT
		}	
 
		add_country_modifier = { 
			name = sp_flavor_80yw_alva_harsh
			duration = 7300
		}
		low_countries_region = {
			add_province_modifier = { 
				name = sp_flavor_80yw_alva_harsh_province
				duration = 7300
			}
		}
		set_country_flag = sp_flavor_80yw_alva_harsh_flag
		custom_tooltip = sp_flavor_80yw_antagonize
    }
    # Send a local general replace the governor and restore order in the Netherlands
    option = {
		trigger = {
			NOT = {	
				OR = { 
					tag = CAS 
					tag = SPA
				}
			} 
		}
       	name = "sp_flavor_80yw.50.b"
	
		create_general =  { tradition = 50 }
	
		capital_scope = {
			infantry = ROOT
			infantry = ROOT
			infantry = ROOT
			infantry = ROOT
			infantry = ROOT
			infantry = ROOT
			cavalry = ROOT
			cavalry = ROOT
			cavalry = ROOT
		}	
	
		add_country_modifier = { 
			name = sp_flavor_80yw_alva_harsh
			duration = 7300
		}
		low_countries_region = {
			add_province_modifier = { 
				name = sp_flavor_80yw_alva_harsh_province
				duration = 7300
			}
		}

		set_country_flag = sp_flavor_80yw_alva_harsh
		custom_tooltip = sp_flavor_80yw_antagonize
    }
    # Engage in dialogue
    option = {
        name = "sp_flavor_80yw.50.c"
		add_country_modifier = { 
			name = sp_flavor_80yw_alva_concede
			duration = 7300
		}
		low_countries_region = {
			add_province_modifier = { 
				name = sp_flavor_80yw_alva_concede_province
				duration = 7300
			}
		}
		set_country_flag = sp_flavor_80yw_alva_concede_flag
		custom_tooltip = sp_flavor_80yw_placate
    }
}

# Blood Council
country_event = {
	id = sp_flavor_80yw.51
    title = "sp_flavor_80yw.51.t"
	
	is_triggered_only = yes

	desc = {
		trigger = { 
		}
		desc = "sp_flavor_80yw.51.d1"
	}
	desc = {
		trigger = { 
		}
		desc = "sp_flavor_80yw.51.d2"
	}
    picture = CIVIL_WAR_eventPicture
	
	immediate = {
		set_country_flag = sp_flavor_80yw_council
		hidden_effect = {
			country_event = {
				id = sp_flavor_80yw.52
				days = 365
			}
		}
	}

    # Institute a Council of Troubles
    option = {
        name = "sp_flavor_80yw.51.a"

		add_country_modifier = { 
			name = sp_flavor_80yw_council_harsh
			duration = 7300
		}
		low_countries_region = {
			add_province_modifier = { 
				name = sp_flavor_80yw_council_harsh_province
				duration = 7300
			}
		}

		set_country_flag = sp_flavor_80yw_council_harsh_flag
		custom_tooltip = sp_flavor_80yw_antagonize
    }
    # Institute a Council of Supervision
    option = {
        name = "sp_flavor_80yw.51.b"
		
		#William of Orange flees the country
		hidden_effect = {
			country_event = {
				id = sp_flavor_80yw.200
				days = 100
			}
		}

		add_country_modifier = { 
			name = sp_flavor_80yw_council_concede
			duration = 7300
		}
		low_countries_region = {
			add_province_modifier = { 
				name = sp_flavor_80yw_council_concede_province
				duration = 7300
			}
		}
		set_country_flag = sp_flavor_80yw_council_concede_flag
		custom_tooltip = sp_flavor_80yw_placate
    }
}

# Egmont and Horne
country_event = {
	id = sp_flavor_80yw.52
    title = "sp_flavor_80yw.52.t"
	
	is_triggered_only = yes

	desc = {
		trigger = { 
		}
		desc = "sp_flavor_80yw.52.d1"
	}
	desc = {
		trigger = { 
		}
		desc = "sp_flavor_80yw.52.d2"
	}
    picture = CIVIL_WAR_eventPicture
	
	immediate = {
		set_country_flag = sp_flavor_80yw_eah
		hidden_effect = {
			country_event = {
				id = sp_flavor_80yw.53
				days = 365
			}
		}
	}

    # Behead them!
    option = {
        name = "sp_flavor_80yw.52.a"

		add_country_modifier = { 
			name = sp_flavor_80yw_eah_harsh
			duration = 7300
		}
		low_countries_region = {
			add_province_modifier = { 
				name = sp_flavor_80yw_eah_harsh_province
				duration = 7300
			}
		}

		set_country_flag = sp_flavor_80yw_eah_harsh_flag
		custom_tooltip = sp_flavor_80yw_antagonize
    }
    # Let them go free.
    option = {
        name = "sp_flavor_80yw.52.b"
		
		add_country_modifier = { 
			name = sp_flavor_80yw_eah_concede
			duration = 7300
		}
		set_country_flag = sp_flavor_80yw_eah_concede_flag
		custom_tooltip = sp_flavor_80yw_placate
    }
}

# Tiende Penning
country_event = {
	id = sp_flavor_80yw.53
    title = "sp_flavor_80yw.53.t"
	
	is_triggered_only = yes

	desc = {
		trigger = { 
		}
		desc = "sp_flavor_80yw.53.d1"
	}
	desc = {
		trigger = { 
		}
		desc = "sp_flavor_80yw.53.d2"
	}
    picture = CIVIL_WAR_eventPicture


	immediate = {
		set_country_flag = sp_flavor_80yw_10p
	}

    # Institute an additional tax!
    option = {
        name = "sp_flavor_80yw.53.a"

		add_country_modifier = { 
			name = sp_flavor_80yw_10p_harsh
			duration = 7300
		}
		low_countries_region = {
			add_province_modifier = { 
				name = sp_flavor_80yw_10p_harsh_province
				duration = 7300
			}
		}

		set_country_flag = sp_flavor_80yw_10p_harsh_flag
		custom_tooltip = sp_flavor_80yw_antagonize
    }
    # Relieve the Dutch of the tax effort.
    option = {
        name = "sp_flavor_80yw.53.b"
		
		add_country_modifier = { 
			name = sp_flavor_80yw_10p_concede
			duration = 7300
		}
		set_country_flag = sp_flavor_80yw_10p_concede_flag
		custom_tooltip = sp_flavor_80yw_placate
    }
}

# Dutch proclaim loyalty
country_event = {
	id = sp_flavor_80yw.60
	
	id = sp_flavor_80yw.60
    title = "sp_flavor_80yw.60.t"

	desc = "sp_flavor_80yw.60.d"

	trigger = {
		has_country_flag = sp_flavor_80yw_begin
		has_country_flag = sp_flavor_80yw_alva
		has_country_flag = sp_flavor_80yw_council
		has_country_flag = sp_flavor_80yw_eah
		has_country_flag = sp_flavor_80yw_10p
		NOT = {
			has_country_flag = sp_flavor_80yw_begin_harsh
			has_country_flag = sp_flavor_80yw_alva_harsh
			has_country_flag = sp_flavor_80yw_council_harsh
			has_country_flag = sp_flavor_80yw_eah_harsh
			has_country_flag = sp_flavor_80yw_10p_harsh
		}
		NOT = {
			has_country_flag = sp_flavor_80yw_dutch_independence_phase2
		}
	}
	immediate = {
		hidden_effect = {
			set_country_flag = sp_flavor_80yw_dutch_independence_phase2
		}
	}

	#Crisis averted
    option = {
        name = "sp_flavor_80yw.60.a"

		custom_tooltip = sp_flavor_80yw_antagonize
    }
}

# Dutch seek allies from abroad...
country_event = {
	id = sp_flavor_80yw.61
	
	id = sp_flavor_80yw.61
    title = "sp_flavor_80yw.61.t"
	
	desc = "sp_flavor_80yw.61.d"

	trigger = {
		has_country_flag = sp_flavor_80yw_begin
		has_country_flag = sp_flavor_80yw_alva
		has_country_flag = sp_flavor_80yw_council
		has_country_flag = sp_flavor_80yw_eah
		has_country_flag = sp_flavor_80yw_10p
		NOT = {
			has_country_flag = sp_flavor_80yw_begin_concede
			has_country_flag = sp_flavor_80yw_alva_concede
			has_country_flag = sp_flavor_80yw_council_concede
			has_country_flag = sp_flavor_80yw_eah_concede
			has_country_flag = sp_flavor_80yw_10p_concede
		}
		NOT = {
			has_country_flag = sp_flavor_80yw_dutch_independence_phase2
		}
	}
	immediate = {
		hidden_effect = {
			set_country_flag = sp_flavor_80yw_dutch_independence_phase2
			FRA = {
				country_event = {
					id = sp_flavor_80yw.62
				}
			}
			GBR = {
				country_event = {
					id = sp_flavor_80yw.62
				}
			}
			if {
				limit = { 
					NOT = { exists = GBR }
				}
				ENG = {
					country_event = {
						id = sp_flavor_80yw.62
					}
				}
			}
			SPA = {
				country_event = {
					id = sp_flavor_80yw.62
				}
			}
			if = {
				limit = { 
					NOT = { exists = SPA }
				}
				CAS = {
					country_event = {
						id = sp_flavor_80yw.62
					}
				}
			}
			emperor = {
				country_event = {
					id = sp_flavor_80yw.62
				}
			}
			TUR = {
				country_event = {
					id = sp_flavor_80yw.62
				}
			}
			every_rival_country = { 
				country_event = {
					id = sp_flavor_80yw.62
				}
			}
		}
	}

	# How dare they? Blasted traitors! 
    option = {
        name = "sp_flavor_80yw.61.a"

		custom_tooltip = sp_flavor_80yw_antagonize
    }
}

# Dutch ask for aid 
country_event = {
	id = sp_flavor_80yw.62
	
	id = sp_flavor_80yw.62
    title = "sp_flavor_80yw.62.t"
	
	desc = {
		trigger = { 
			tag = FRA
		}
		desc = "sp_flavor_80yw.62.d1"
	}
	desc = {
		trigger = { 
			or = {
				tag = ENG
				tag = GBR
			}
		}
		desc = "sp_flavor_80yw.62.d2"
	}
	desc = {
		trigger = { 
			or = {
				tag = CAS
				tag = SPA
			}
		}
		desc = "sp_flavor_80yw.62.d3"
	}
	desc = {
		trigger = { 
			emperor = yes
		}
		desc = "sp_flavor_80yw.62.d3"
	}
	desc = {
		trigger = { 
			tag = TUR
		}
		desc = "sp_flavor_80yw.62.d5"
	}
	desc = {
		trigger = { 
			not = {
				or = {
					tag = FRA
					tag = ENG
					tag = GBR
					tag = CAS
					tag = SPA
					emperor = yes
					tag = TUR
				}
			}
		}
		desc = "sp_flavor_80yw.62.d6"
	}

	trigger = {
		NOT = {
			has_country_flag = sp_flavor_80yw_dutch_independence_phase2
		}
	}

	# Ally
    option = {
        name = "sp_flavor_80yw.62.a"

		custom_tooltip = sp_flavor_80yw_ally
    }
	# Help
    option = {
        name = "sp_flavor_80yw.62.b"

		custom_tooltip = sp_flavor_80yw_help
    }
	# Ignore
    option = {
        name = "sp_flavor_80yw.62.c"

		custom_tooltip = sp_flavor_80yw_ignore
    }
}

# Dutch declare independance

# William of Orange

# Proclaim William Stadtholder

# William of Orange events
# William of Orange flees the country 
country_event = {
	id = sp_flavor_80yw.200
    title = "sp_flavor_80yw.200.t"
	
	is_triggered_only = yes

	desc = "sp_flavor_80yw.200.d"
    picture = CIVIL_WAR_eventPicture
	
	immediate = {
		hidden_effect = {
			country_event = {
				id = sp_flavor_80yw.201
				days = 365
			}
		}
	}

    # William of Orange flees the country
    option = {
        name = "sp_flavor_80yw.200.a"
    }
}

# William of Orange returns in order to restore order
country_event = {
	id = sp_flavor_80yw.201
    title = "sp_flavor_80yw.201.t"
	
	is_triggered_only = yes

	desc = "sp_flavor_80yw.201.d"
    picture = CIVIL_WAR_eventPicture

    # William of Orange tries to restore order in name of the king 
    option = {
        name = "sp_flavor_80yw.201.a"
		random_owned_province = {
			limit = { 
				region = low_countries_region 
			}
			spawn_rebels = {
				type = nationalist_rebels
				size = 3
				culture = dutch
				win = yes
				friend = NED
				leader = "Willem van Oranje"
			}
		}
	}
}